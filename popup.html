<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Flow Monitor</title>
    <style>
        :root {
            --primary: #0078d4;
            --primary-hover: #106ebe;
            --text: #323130;
            --bg: #ffffff;
            --border: #e1dfdd;
        }
        body {
            width: 320px;
            padding: 0;
            margin: 0;
            font-family: 'Segoe UI', -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            overflow: hidden;
        }
        .header {
            padding: 16px 20px;
            background: #f3f2f1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
        }
        h2 {
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
        }
        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            color: #605e5c;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-btn:hover { background: #e1dfdd; color: var(--text); }
        .icon-btn svg { width: 16px; height: 16px; fill: currentColor; }

        .content { padding: 20px; text-align: center; }

        /* Launch View */
        #launch-view { display: flex; flex-direction: column; gap: 16px; }
        .hero-icon { width: 48px; height: 48px; margin: 0 auto; fill: var(--primary); }
        
        /* Settings View */
        #settings-view { display: none; text-align: left; animation: slideIn 0.2s ease-out; }
        @keyframes slideIn { from { transform: translateX(20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .form-group { margin-bottom: 12px; }
        label { display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; }
        input[type="text"] {
            width: 100%; padding: 8px 10px; border: 1px solid var(--border);
            border-radius: 4px; font-size: 13px; box-sizing: border-box;
            transition: border-color 0.2s;
        }
        input[type="text"]:focus { border-color: var(--primary); outline: none; }

        /* Buttons */
        .btn {
            width: 100%; padding: 10px; border: none; border-radius: 4px;
            cursor: pointer; font-size: 13px; font-weight: 600;
            transition: background 0.1s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-primary:disabled { background: #c8c6c4; cursor: not-allowed; }
        
        .btn-secondary { background: #f3f2f1; color: var(--text); margin-top: 8px; }
        .btn-secondary:hover { background: #e1dfdd; }

        .status { font-size: 11px; margin-top: 8px; min-height: 16px; text-align: center; }
        .status.error { color: #d13438; }
        .status.success { color: #107c10; }
        
        .hint { font-size: 11px; color: #605e5c; margin-top: 4px; }
    </style>
</head>
<body>
    <div class="header">
        <h2>Flow Monitor</h2>
        <button id="settings-toggle" class="icon-btn" title="Settings">
            <svg viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/></svg> <!-- Simple gear/placeholder -->
        </button>
    </div>

    <div class="content">
        <!-- Launcher -->
        <div id="launch-view">
            <svg class="hero-icon" viewBox="0 0 24 24">
                <path d="M2.5,12 L20.5,12 L14,5.5" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M20,12 L14,18.5" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div style="font-size: 13px; color: #605e5c;">Monitor Power Automate runs for this record.</div>
            <button id="launchBtn" class="btn btn-primary">Open Flow Monitor</button>
            <div id="launch-status" class="status"></div>
        </div>

        <!-- Settings -->
        <div id="settings-view">
            <div class="form-group">
                <label for="clientId">Azure AD Client ID</label>
                <input type="text" id="clientId" placeholder="Application (client) ID">
            </div>
            <div class="form-group">
                <label for="tenantId">Tenant ID</label>
                <input type="text" id="tenantId" placeholder="Directory (tenant) ID">
                <div class="hint">Required for single-tenant apps.</div>
            </div>
            <button id="saveBtn" class="btn btn-primary">Save Settings</button>
            <button id="backBtn" class="btn btn-secondary">Back</button>
            <div id="setting-status" class="status"></div>
        </div>
    </div>
    
    <script src="popup.js"></script>
</body>
</html>